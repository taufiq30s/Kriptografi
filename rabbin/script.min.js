function zeroPad(a,t){var i=t-a.toString(2).length+1;return Array(+(i>0&&i)).join("0")+a}function power(a,t,i){var e=1;for(a%=i;t>0;)1&t&&(e=e*a%i),t>>=1,a=a*a%i;return e}function isPrime(a){if(isNaN(a)||!isFinite(a)||a%1||a<2)return!1;if(a%2==0)return 2==a;if(a%3==0)return 3==a;for(var t=Math.sqrt(a),i=5;i<=t;i+=6){if(a%i==0)return!1;if(a%(i+2)==0)return!1}return!0}function eea(a,t){for(var i=parseInt(t),e=parseInt(a),r=0,n=1;0!=e;)y=Math.floor(i/e),g2=i-y*e,i=e,e=g2,v2=r-y*n,r=n,n=v2;return r>=0?r:r+parseInt(t)}function DupKey(a,t,i,e,r,n){this.name=a,this.chara=t,this.asciiChr=i,this.chrBin=e,this.dupBin=r,this.des=n}function Chipper(a,t,i){this.chara=a,this.miDec=t,this.Ch=i}function Decrypt(a,t,i,e,r,n,o,l,s,c){this.chara=a,this.nilaiChipper=t,this.r=i,this.s=e,this.x=r,this.y=n,this.x2=o,this.y2=l,this.real=s,this.char=c}function encryptTable(){duplicateData=getDuplication(getPlainText()),chipperData=getChipper(duplicateData),duplicate=$("#dt_char").DataTable({processing:!1,serverSide:!1,ordering:!1,searching:!1,bLengthChange:!1,info:!1,paging:!1,data:duplicateData,columns:[{data:"name"},{data:"chara"},{data:"asciiChr"},{data:"chrBin"},{data:"dupBin"},{data:"des"}]}),chipper=$("#dt_chipper").DataTable({processing:!1,serverSide:!1,ordering:!1,searching:!1,bLengthChange:!1,info:!1,paging:!1,data:chipperData,columns:[{data:"chara"},{data:"miDec"},{data:"Ch"}]})}function decrypt(a,t){rootSquareData=getRootSquare(a,t),decrpt=$("#dt_decrypt").DataTable({processing:!1,serverSide:!1,ordering:!1,searching:!1,bLengthChange:!1,info:!1,paging:!1,data:rootSquareData,columns:[{data:"chara"},{data:"nilaiChipper"},{data:"r"},{data:"s"},{data:"x"},{data:"y"},{data:"x2"},{data:"y2"},{data:"real"},{data:"char"}]})}function getDuplication(a){for(var t=a.toString().split(""),i=[],e=0;e<t.length;e++){var r="M"+(e+1),n=t[e].charCodeAt(),o=zeroPad(n.toString(2),8),l=o+o,s=parseInt(l,2);i.push(new DupKey(r,t[e],n,o,l,s))}return i}function getChipper(a){for(var t=getDecDup(a),i=(a=[],0);i<t.length;i++){var e="C"+(i+1),r=t[i],n=r*r%$("#n").val();a.push(new Chipper(e,r,n)),chipperStorage.push(n)}return a}function getRootSquare(a,t){for(var i=parseInt($("#pDec").val()),e=parseInt($("#qDec").val()),r=i*e,n=[],o="Not Found",l="-",s=0;s<chipperStorage.length;s++){var c="C"+(s+1),h=power(chipperStorage[s],Math.floor((i+1)/4),i),p=power(chipperStorage[s],Math.floor((e+1)/4),e),d=Math.abs((a*i*p+t*e*h)%r),u=Math.abs((a*i*p-t*e*h)%r),g=r-d,f=r-u;originalSR(d)?o="Xi":originalSR(g)?o="-Xi":originalSR(u)?o="Yi":originalSR(f)&&(o="-Yi"),"Not Found"!=o&&("Xi"===o?l=toChar(d):"-Xi"===o?l=toChar(g):"Yi"===o?l=toChar(u):"-Yi"===o&&(l=toChar(f))),n.push(new Decrypt(c,chipperStorage[s],h,p,d,u,g,f,o,l)),$("#trueMessage").val($("#trueMessage").val()+l)}return n}function originalSR(a){a<0&&(a*=-1);var t=a.toString(2);return!(t.length>16)&&(t.length<16&&(t=zeroPad(t,16)),t=t.match(/.{1,8}/g),t[0]==t[1])}function toChar(a){return a<0&&(a*=-1),String.fromCharCode(a%128)}function getDecDup(a){for(var t=[],i=0;i<a.length;i++)t.push(a[i].des);return t}function getPlainText(){return $("#plainText").val()}function checkPQ(a,t){return pOld=$("#p").val(),qOld=$("#q").val(),a==pOld&&t==qOld}$("#rabinWizard").smartWizard({selected:0,autoAdjustHeight:!1,keyNavigation:!1,lang:{next:"Selanjutnya",previous:"Sebelumnya"},useURLhash:!1,showStepURLhash:!1,toolbarSettings:{toolbarPosition:"bottom",toolbarButtonPosition:"right",showNextButton:!0,showPreviousButton:!0,toolbarExtraButtons:[$("<button></button>").text("Finish").addClass("btn btn-info sw-btn-fin").on("click",function(){swal("Terima Kasih.","Terima Kasih Telah Menggunakan Web ini","success"),location.reload()})]},anchorSettings:{anchorClickable:!0,enableAllAnchors:!1,markDoneStep:!0,enableAnchorOnDoneStep:!0,removeDoneStepOnNavigateBack:!0},theme:"dots",transitionEffect:"fade",transitionSpeed:"400"}),$(".sw-btn-fin").hide(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),$("#rabinWizard").on("showStep",function(a,t,i,e,r){"final"!=r?($(".sw-btn-fin").hide(),$(".sw-btn-next").show()):($(".sw-btn-next").hide(),$(".sw-btn-fin").show())}),$("#p,#q").keyup(function(){$("#n").val($("#p").val()*$("#q").val())}),$("#rabinWizard").on("leaveStep",function(a,t,i,e){if(1!==i)return!0;var r=parseInt($("#p").val()),n=parseInt($("#q").val());if("forward"===e){var o=isPrime(r),l=isPrime(n);return!(!o||!l||(r+1)%4!=0||(n+1)%4!=0)||(!o&&l?swal("Nilai P Bukan Prima","Pastikan P adalah Bilangan Prima","error"):o&&!l?swal("Nilai Q Bukan Prima","Pastikan Q adalah Bilangan Prima","error"):o||l?(r+1)%4!=0&&(n+1)%4==0?swal("Nilai P Tidak Valid","Nilai P harus bernai 0, jika (P+1) mod 4","error"):(r+1)%4!=0&&(r+1)%4==0?swal("Nilai Q Tidak Valid","Nilai Q harus bernai 0, jika (Q+1) mod 4","error"):(r+1)%4!=0&&(r+1)%4!=0&&swal("Nilai P dan Q Tidak Valid","Nilai P dan Q harus bernai 0, jika (P (atau) Q+1) mod 4","error"):swal("Nilai P dan Q Bukan Prima","Pastikan P dan Q adalah Bilangan Prima","error"),!1)}});var chipperStorage=[],tableFirstInisialized=0;$("#encrypt").click(function(){chipperStorage=[],0==tableFirstInisialized?(encryptTable(),tableFirstInisialized=1):(duplicate.clear().destroy(),chipper.clear().destroy(),encryptTable())});var tableDecInisialized=0;$("#decrypt").click(function(){var a,t;checkPQ($("#pDec").val(),$("#qDec").val())?($("#trueMessage").val(""),a=eea($("#pDec").val(),$("#qDec").val()),$("#aDec").val(a),t=eea($("#qDec").val(),$("#pDec").val()),$("#bDec").val(t),0==tableDecInisialized?(decrypt(a,t),tableDecInisialized=1):(decrpt.clear().destroy(),decrypt(a,t))):swal("Nilai P atau Q tidak sama","Pastikan nilai P dan Q sama dengan nilai P dan Q di bagian pembentukan kunci","error")});